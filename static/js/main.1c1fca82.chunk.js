(this["webpackJsonpimg-scanner"]=this["webpackJsonpimg-scanner"]||[]).push([[0],{128:function(e,t,n){},130:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),s=n(39),a=n.n(s),i=(n(52),n(13)),c=(n(53),n(54),function(){return o.a.createElement("nav",{className:"bottom-nav-wrapper"},"made by Ian Huang")}),u=n(29),f=n(11),l=n.n(f),d=n(18),h=n(135),m=n(136),p=n(139),g=n(137),v=n(138),b=n(22),y=n(40),w=n(23),x=n.n(w),j=n(41),k=n.n(j),P=function(){return k()('!function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="/image-scanner/",e(e.s=1)}([function(t,r,e){var n,o,f;!function(t){if(!t.numeric){var r={dim:function(t){var e;return"object"===typeof t?"object"===typeof(e=t[0])?"object"===typeof e[0]?r._dim(t):[t.length,e.length]:[t.length]:[]},_foreach2:function t(r,e,n,o){if(n===e.length-1)return o(r);var f,i=e[n],s=Array(i);for(f=i-1;f>=0;f--)s[f]=t(r[f],e,n+1,o);return s},cloneV:function(t){var r,e=t.length,n=Array(e);for(r=e-1;-1!==r;--r)n[r]=t[r];return n},clone:function(t){if("object"!==typeof t)return t;var e=r.cloneV,n=r.dim(t);return r._foreach2(t,n,0,e)},diag:function(t){var r,e,n,o,f=t.length,i=Array(f);for(r=f-1;r>=0;r--){for(o=Array(f),e=r+2,n=f-1;n>=e;n-=2)o[n]=0,o[n-1]=0;for(n>r&&(o[n]=0),o[r]=t[r],n=r-1;n>=1;n-=2)o[n]=0,o[n-1]=0;0===n&&(o[0]=0),i[r]=o}return i},rep:function(t,e,n){"undefined"===typeof n&&(n=0);var o,f=t[n],i=Array(f);if(n===t.length-1){for(o=f-2;o>=0;o-=2)i[o+1]=e,i[o]=e;return-1===o&&(i[0]=e),i}for(o=f-1;o>=0;o--)i[o]=r.rep(t,e,n+1);return i},identity:function(t){return r.diag(r.rep([t],1))},inv:function(t){var e,n,o,f,i,s,c,u,a=r.dim(t),h=Math.abs,d=a[0],l=a[1],y=r.clone(t),p=r.identity(d);for(s=0;s<l;++s){var v=-1,m=-1;for(i=s;i!==d;++i)(c=h(y[i][s]))>m&&(v=i,m=c);for(n=y[v],y[v]=y[s],y[s]=n,f=p[v],p[v]=p[s],p[s]=f,u=n[s],c=s;c!==l;++c)n[c]/=u;for(c=l-1;-1!==c;--c)f[c]/=u;for(i=d-1;-1!==i;--i)if(i!==s){for(e=y[i],o=p[i],u=e[s],c=s+1;c!==l;++c)e[c]-=n[c]*u;for(c=l-1;c>0;--c)o[c]-=f[c]*u,o[--c]-=f[c]*u;0===c&&(o[0]-=f[0]*u)}}return p},dotMMsmall:function(t,r){var e,n,o,f,i,s,c,u,a,h,d;for(f=t.length,i=r.length,s=r[0].length,c=Array(f),e=f-1;e>=0;e--){for(u=Array(s),a=t[e],o=s-1;o>=0;o--){for(h=a[i-1]*r[i-1][o],n=i-2;n>=1;n-=2)d=n-1,h+=a[n]*r[n][o]+a[d]*r[d][o];0===n&&(h+=a[0]*r[0][o]),u[o]=h}c[e]=u}return c},dotMV:function(t,e){var n,o=t.length,f=Array(o),i=r.dotVV;for(n=o-1;n>=0;n--)f[n]=i(t[n],e);return f},dotVV:function(t,r){var e,n,o=t.length,f=t[o-1]*r[o-1];for(e=o-2;e>=1;e-=2)n=e-1,f+=t[e]*r[e]+t[n]*r[n];return 0===e&&(f+=t[0]*r[0]),f},transpose:function(t){var r,e,n,o,f,i=t.length,s=t[0].length,c=Array(s);for(e=0;e<s;e++)c[e]=Array(i);for(r=i-1;r>=1;r-=2){for(o=t[r],n=t[r-1],e=s-1;e>=1;--e)(f=c[e])[r]=o[e],f[r-1]=n[e],(f=c[--e])[r]=o[e],f[r-1]=n[e];0===e&&((f=c[0])[r]=o[0],f[r-1]=n[0])}if(0===r){for(n=t[0],e=s-1;e>=1;--e)c[e][0]=n[e],c[--e][0]=n[e];0===e&&(c[0][0]=n[0])}return c}};this.numeric=r,t.numeric=r}}(this),f=function(){"use strict";function t(t,r,e){if(e){var n=r;r=t,t=n}var o,f=[[t[0],t[1],1,0,0,0,-1*r[0]*t[0],-1*r[0]*t[1]],[0,0,0,t[0],t[1],1,-1*r[1]*t[0],-1*r[1]*t[1]],[t[2],t[3],1,0,0,0,-1*r[2]*t[2],-1*r[2]*t[3]],[0,0,0,t[2],t[3],1,-1*r[3]*t[2],-1*r[3]*t[3]],[t[4],t[5],1,0,0,0,-1*r[4]*t[4],-1*r[4]*t[5]],[0,0,0,t[4],t[5],1,-1*r[5]*t[4],-1*r[5]*t[5]],[t[6],t[7],1,0,0,0,-1*r[6]*t[6],-1*r[6]*t[7]],[0,0,0,t[6],t[7],1,-1*r[7]*t[6],-1*r[7]*t[7]]],i=r;try{o=numeric.inv(numeric.dotMMsmall(numeric.transpose(f),f))}catch(h){return console.log(h),[1,0,0,0,1,0,0,0]}for(var s,c=numeric.dotMMsmall(o,numeric.transpose(f)),u=numeric.dotMV(c,i),a=0;a<u.length;a++)u[a]=(s=u[a],Math.round(1e10*s)/1e10);return u[8]=1,u}function r(e,n){return"undefined"!==typeof window&&window===this||void 0===this?new r(e,n):(this.srcPts=e,this.dstPts=n,this.coeffs=t(this.srcPts,this.dstPts,!1),this.coeffsInv=t(this.srcPts,this.dstPts,!0),this)}return r.prototype={transform:function(t,r){var e=[];return e[0]=(this.coeffs[0]*t+this.coeffs[1]*r+this.coeffs[2])/(this.coeffs[6]*t+this.coeffs[7]*r+1),e[1]=(this.coeffs[3]*t+this.coeffs[4]*r+this.coeffs[5])/(this.coeffs[6]*t+this.coeffs[7]*r+1),e},transformInverse:function(t,r){var e=[];return e[0]=(this.coeffsInv[0]*t+this.coeffsInv[1]*r+this.coeffsInv[2])/(this.coeffsInv[6]*t+this.coeffsInv[7]*r+1),e[1]=(this.coeffsInv[3]*t+this.coeffsInv[4]*r+this.coeffsInv[5])/(this.coeffsInv[6]*t+this.coeffsInv[7]*r+1),e}},r},void 0!==typeof t?t.exports=f():void 0===(o="function"===typeof(n=f)?n.call(r,e,r,t):n)||(t.exports=o)},function(t,r,e){"use strict";e.r(r);var n=e(0),o=e.n(n);self.onmessage=function(t){const{points:r,background:{width:e,height:n}}=t.data,f=r.map(t=>({d:Math.sqrt(t.x**2+t.y**2),p:t})).sort((t,r)=>t.d-r.d)[0].p,i=r.map(t=>({d:Math.sqrt((t.x-e)**2+t.y**2),p:t})).sort((t,r)=>t.d-r.d)[0].p,s=r.map(t=>({d:Math.sqrt(t.x**2+(t.y-n)**2),p:t})).sort((t,r)=>t.d-r.d)[0].p,c=r.map(t=>({d:Math.sqrt((t.x-e)**2+(t.y-n)**2),p:t})).sort((t,r)=>t.d-r.d)[0].p,u=(Math.sqrt((f.x-i.x)**2+(f.y-i.y)**2)+Math.sqrt((c.x-s.x)**2+(c.y-s.y)**2))/2,a=(Math.sqrt((f.x-s.x)**2+(f.y-s.y)**2)+Math.sqrt((c.x-i.x)**2+(c.y-i.y)**2))/2,h=[f.x,f.y,i.x,i.y,c.x,c.y,s.x,s.y],d=[0,0,u,0,u,a,0,a],l=o()(h,d);self.postMessage({matrix:l,width:u,height:a})}}]);\n//# sourceMappingURL=Matrix.worker.80242c70.worker.js.map',"Worker",void 0,n.p+"static/js/Matrix.worker.80242c70.worker.js")},E=function(){function e(){var t=this;Object(b.a)(this,e),this.setup=function(e,n){t.terminate(),t.container=e,t.x=e.offsetWidth/2,t.y=e.offsetHeight/2,t.scale=1,t.mousePressed=!1,t.sketch=function(r){n&&(r.preload=function(){t.background=r.loadImage(n)},r.setup=function(){var t=r.createCanvas(e.offsetWidth,e.offsetHeight);t.elt.addEventListener("contextmenu",(function(e){return e.preventDefault()})),t.parent(e),r.imageMode(r.CENTER)},r.draw=function(){var e=t.background.width*t.scale,n=t.background.height*t.scale;r.clear(),r.image(t.background,t.x,t.y,e,n),t.points.forEach((function(o){var s=o.x,a=o.y;r.noStroke(),r.fill("#e84a5f"),r.rectMode(r.CENTER),r.rect(t.x+s*t.scale-e/2,t.y+a*t.scale-n/2,10*t.scale,10*t.scale)}))},r.mousePressed=function(){if(!(r.mouseX<0||r.mouseX>r.width||r.mouseY<0||r.mouseY>r.height)){var e=(r.mouseX-t.x)/t.scale+t.background.width/2,n=(r.mouseY-t.y)/t.scale+t.background.height/2,o=t.points.findIndex((function(r){var o=r.x,s=r.y;return e>=o-10*t.scale/2&&e<=o+10*t.scale/2&&n>=s-10*t.scale/2&&n<=s+10*t.scale/2}));r.mouseButton===r.RIGHT&&-1!==o?t.reactRemovePoint(o):r.mouseButton===r.LEFT&&t.isPinning&&e>=0&&e<=t.background.width&&n>=0&&n<=t.background.height&&t.reactAddPoint(e,n),t.startX=r.mouseX,t.startY=r.mouseY,t.mousePressed=!0}},r.mouseReleased=function(){t.mousePressed=!1},r.mouseDragged=function(){if(!t.isPinning&&t.mousePressed&&!(r.mouseX<0||r.mouseX>r.width||r.mouseY<0||r.mouseY>r.height)){var e=t.startX-r.mouseX,n=t.startY-r.mouseY;t.x-=e,t.y-=n,t.startX=r.mouseX,t.startY=r.mouseY}},r.mouseWheel=function(e){if(!t.isPinning&&!(r.mouseX<0||r.mouseX>r.width||r.mouseY<0||r.mouseY>r.height)){var n=e.delta;t.scale+=n/1e3}},r.windowResized=function(){r.resizeCanvas(e.offsetWidth,e.offsetHeight)})},t.p5instance=new x.a(t.sketch)},this.setPinning=function(e){t.p5instance&&(t.container.style.cursor=e?"crosshair":"grab",t.isPinning=e)},this.setAddPoint=function(e){return t.reactAddPoint=e},this.setRemovePoint=function(e){return t.reactRemovePoint=e},this.setPoints=function(e){return t.points=e},this.project=Object(d.a)(l.a.mark((function e(){var n,r,o,s,a,i,c,u,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var s=new P;s.postMessage({points:t.points,background:{width:t.background.width,height:t.background.height}}),s.onmessage=function(t){n=t.data.matrix,r=t.data.width,o=t.data.height,e()}}));case 2:for(s=n.coeffsInv,t.background.loadPixels(),(a=t.p5instance.createImage(Math.floor(r),Math.floor(o))).loadPixels(),i=0;i<a.width;i++)for(c=0;c<a.height;c++)u=t.transformInverse(i,c,s),f=t.background.get(Math.floor(u.x),Math.floor(u.y)),a.set(i,c,f);return a.updatePixels(),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),this.transformInverse=function(e,t,n){var r={};return r.x=(n[0]*e+n[1]*t+n[2])/(n[6]*e+n[7]*t+1),r.y=(n[3]*e+n[4]*t+n[5])/(n[6]*e+n[7]*t+1),r},this.terminate=function(){t.p5instance&&t.p5instance.remove()}}return Object(y.a)(e,[{key:"enabled",get:function(){return!!this.p5instance}}]),e}(),O=(n(57),function(e){var t=e.image,n=e.setImage,s=e.setResult,a=Object(r.useRef)(null),c=Object(r.useRef)(null),f=Object(r.useRef)(new E),b=Object(r.useState)(!1),y=Object(i.a)(b,2),w=y[0],x=y[1],j=Object(r.useState)([]),k=Object(i.a)(j,2),P=k[0],O=k[1],M=function(){var e=Object(d.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.target.files&&t.target.files[0]&&((r=new FileReader).onload=function(e){n((function(){return e.target.result}))},r.readAsDataURL(t.target.files[0]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=Object(r.useCallback)((function(e,t){var n=[].concat(Object(u.a)(P),[{x:e,y:t}]);O((function(){return n})),4===n.length&&x(!1)}),[P]),Y=Object(r.useCallback)((function(e){var t=Object(u.a)(P);t.splice(e,1),O((function(){return t})),x(!0)}),[P]);return Object(r.useEffect)((function(){!f.current.enabled&&t&&f.current.setup(a.current,t)}),[a,t]),Object(r.useEffect)((function(){f.current.setAddPoint(X)}),[X]),Object(r.useEffect)((function(){f.current.setRemovePoint(Y)}),[Y]),Object(r.useEffect)((function(){f.current.setPoints(P)}),[P]),Object(r.useEffect)((function(){f.current.setPinning(w)}),[t,w]),Object(r.useEffect)((function(){document.body.addEventListener("keydown",(function(e){"Escape"===e.key&&x(!1)}))})),o.a.createElement("div",{className:"canvas-wrapper"},o.a.createElement("div",{className:"canvas-main",ref:a,onClick:function(){t||c.current.click()}},o.a.createElement("input",{ref:c,type:"file",accept:"image/png, image/jpeg",hidden:!0,onChange:M}),!f.current.enabled&&o.a.createElement(o.a.Fragment,null,o.a.createElement(h.a,{size:100,color:"#dbe2ef77"}),o.a.createElement(m.a,{color:"#959ba577",textAlign:"center",marginTop:10},"Click to upload image"))),o.a.createElement("div",{className:"canvas-toolbox"},o.a.createElement(p.a,{iconAfter:g.a,appearance:"primary",intent:"success",marginRight:8,disabled:!t||4===P.length,height:40,onClick:function(){return x(!w)}},w&&4!==P.length?o.a.createElement("span",null,"Pinning... (",4-P.length,")"):o.a.createElement("span",null,"Pin Points (",4-P.length,")")),o.a.createElement(p.a,{appearance:"primary",intent:"danger",disabled:4!==P.length,height:40,iconAfter:v.a,onClick:Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=s,e.next=3,f.current.project();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))},"Flatten")))}),M=function e(){var t=this;Object(b.a)(this,e),this.setup=function(e,n){t.terminate(),t.x=0,t.y=0,t.scale=1,t.background=n,t.mousePressed=!1,t.sketch=function(r){n&&(t.background=n,r.setup=function(){r.createCanvas(e.offsetWidth,e.offsetHeight,r.WEBGL).parent(e),r.imageMode(r.CENTER),r.noFill()},r.draw=function(){t.background&&(r.clear(),r.image(t.background,t.x,t.y,t.background.width*t.scale,t.background.height*t.scale))},r.mousePressed=function(){r.mouseX<0||r.mouseX>r.width||r.mouseY<0||r.mouseY>r.height||(t.startX=r.mouseX,t.startY=r.mouseY,t.mousePressed=!0)},r.mouseReleased=function(){t.mousePressed=!1},r.mouseDragged=function(){if(t.mousePressed&&!(r.mouseX<0||r.mouseX>r.width||r.mouseY<0||r.mouseY>r.height)){var e=t.startX-r.mouseX,n=t.startY-r.mouseY;t.x-=e,t.y-=n,t.startX=r.mouseX,t.startY=r.mouseY}},r.mouseWheel=function(e){if(!(r.mouseX<0||r.mouseX>r.width||r.mouseY<0||r.mouseY>r.height)){var n=e.delta;t.scale+=n/1e3}},r.windowResized=function(){r.resizeCanvas(e.offsetWidth,e.offsetHeight)})},t.p5instance=new x.a(t.sketch)},this.terminate=function(){t.p5instance&&t.p5instance.remove()}},X=(n(128),function(e){var t=e.result,n=Object(r.useRef)(null),s=Object(r.useRef)(new M);return Object(r.useEffect)((function(){t&&s.current.setup(n.current,t)}),[n,t]),o.a.createElement("div",{className:"result-wrapper"},o.a.createElement("div",{className:"result-main",ref:n}))});var Y=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(null),u=Object(i.a)(a,2),f=u[0],l=u[1];return o.a.createElement("div",{className:"app-wrapper"},o.a.createElement("div",{className:"app-content"},o.a.createElement(O,{image:n,setImage:s,setResult:l}),o.a.createElement(X,{result:f})),o.a.createElement(c,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},47:function(e,t,n){e.exports=n(130)},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},57:function(e,t,n){}},[[47,1,2]]]);
//# sourceMappingURL=main.1c1fca82.chunk.js.map